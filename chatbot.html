<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="cache-control" content="no-cache">
		<meta http-equiv="expires" content="0">
		<meta http-equiv="pragma" content="no-cache">
		<meta charset="utf-8">
		<title>Chatbot</title>
		<style type="text/css">
		.dot {
			height: 13px;
			width: 13px;
			background-color: lightgreen;
			border-radius: 50%;
			display: inline-block;
		}
		.talk-bubble {
			margin: 10px;
			display: inline-block;
			position: relative;
			width: 100%;
			height: auto;
			color: white;
		}
		.tri-right.border.left-top:before {
			content: " ";
			position: absolute;
			width: 0;
			height: 0;
			left: -40px;
			right: auto;
			top: -8px;
			bottom: auto;
			border: 32px solid;
			border-color: #666 transparent transparent transparent;
		}
		.tri-right.left-top:after {
			content: " ";
			position: absolute;
			width: 0;
			height: 0;
			left: -20px;
			right: auto;
			top: 0px;
			bottom: auto;
			border: 22px solid;
			border-color: #00aabb transparent transparent transparent;
		}
		.tri-right.border.right-top:before {
			content: " ";
			position: absolute;
			width: 0;
			height: 0;
			left: auto;
			right: -40px;
			top: -8px;
			bottom: auto;
			border: 32px solid;
			border-color: #666 transparent transparent transparent;
		}
		.tri-right.right-top:after {
			content: " ";
			position: absolute;
			width: 0;
			height: 0;
			left: auto;
			right: -20px;
			top: 0px;
			bottom: auto;
			border: 20px solid;
			border-color: #8000ff transparent transparent transparent;
		}
		.talktext {
			padding: 1em;
			text-align: left;
			line-height: 1.5em;
		}
		.talktext p {
			-webkit-margin-before: 0em;
			-webkit-margin-after: 0em;
		}
		.no-border: {
		    border: 0;
		    box-shadow: none;
		}
		.no-border:focus {
		    border: 0;
		    box-shadow: none;
		}
		</style>
	</head>
	<body>
		<nav class="navbar navbar-expand-sm bg-dark">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link text-white" href="#">
						<span class="dot"></span>&nbsp;<span id="state">Chatbot est치 online</span>
					</a>
				</li>
			</ul>
		</nav>
		<br>
		<div>
			<div style="overflow-y:scroll; height: 300px; width: 100%;" align="center" id="msg">
				<div class="talk-bubble tri-right left-top" style="width: 90%; background-color: #00aabb;">
					<div class="talktext">
						<p>Ol치! No que posso ajudar?</p>
					</div>
				</div>
			</div>
			<input type="text" id="question" class="form-control no-border" onkeypress="return Send(event)" placeholder="Digite a sua mensagem e tecle Enter...">
		</div>
		<script type="text/javascript">
			const msg = document.getElementById("msg");
			const question = document.getElementById("question");
			const state = document.getElementById("state");
			let original_question = "";
			async function Send(e) {if(e.keyCode == 13) {await setQuestion();return false;}}
			async function talk() {
				let msgLines = msg.innerHTML;
				msgLines = msgLines.replace(`<a href="#" id="end">`, "");
				const objJSON = conversation(original_question);
				console.log("Prediction:");
				console.log(objJSON);
				const answer = objJSON[0].answer.toString().trim();
				msgLines +=
				`
					<div class="talk-bubble tri-right left-top" style="width: 90%; background-color: #00aabb;">
						<div class="talktext">
							<p>${answer}</p>
						</div>
					</div>
					<a href="#" id="end">
				`;
				await setTimeout(() => {
					msg.innerHTML = msgLines;
					window.location.href = "#end";
					question.focus();
					state.innerText = "Chatbot est치 online";
				}, answer.length*100);
			}
			async function setQuestion() {
				const _question = question.value.toString().trim();
				original_question = _question;
				let msgLines = msg.innerHTML;
				msgLines = msgLines.replace(`<a href="#" id="end">`, "");
				msgLines +=
				`
					<div class="talk-bubble tri-right right-top" style="width: 90%; background-color: #8000ff;">
						<div class="talktext">
							<p>${_question}</p>
						</div>
					</div>
					<a href="#" id="end">
				`;
				question.value = "";
				msg.innerHTML = msgLines;
				window.location.href = "#end";
				question.focus();
				await setTimeout(() => {state.innerText = "Chatbot est치 digitando...";talk();}, 1000);
			}
			function conversation(question="") {try {let objJSON = [];let question1 = question.toString().trim();const original_question = question1;question1 = question1.toLowerCase().normalize("NFD").replace(/([\u0300-\u036f]|[^0-9a-zA-Z ])/g, "").trim();let arrayWords = question1.split(" ");question1 = "";for(let j=0; j<arrayWords.length; j++) {let word = arrayWords[j].toString().trim();if(word.length > 3) {word = word.substr(0, word.length-3);}question1 += word + " ";}question1 = question1.trim();let arrayRegister = _register.split("\n");let count = [];for(let i=0; i<arrayRegister.length; i++) {count.push(0);}let before = -1;try{before = Number(sessionStorage.getItem("before"));}catch(none){before = -1;}let beforeRegister = [];for(let i=0; i<arrayRegister.length; i++) {let lines = [];try{lines = arrayRegister[i].toString().trim().split("|#|");}catch(none){lines = [];}if(lines.length > 0) {let code = Number(lines[2]);if(code == before) {beforeRegister.push(arrayRegister[i].toString().trim())}}}if(beforeRegister.length > 0) {arrayRegister = beforeRegister;}for(let i=0; i<arrayRegister.length; i++) {let lines = [];try{lines = arrayRegister[i].toString().trim().split("|#|");}catch(none){lines = [];}if(lines.length > 0) {let question2 = "";try{question2 = lines[3].toString().toLowerCase().normalize("NFD").replace(/([\u0300-\u036f]|[^0-9a-zA-Z ])/g, "").trim();}catch(none){question2 = "";}if(question2.length <= 0) {lines[4].toString().toLowerCase().normalize("NFD").replace(/([\u0300-\u036f]|[^0-9a-zA-Z ])/g, "").trim();}arrayWords = question2.split(" ");question2 = "";for(let j=0; j<arrayWords.length; j++) {let word = arrayWords[j].toString().trim();if(word.length > 3) {word = word.substr(0, word.length-3);}question2 += word + " ";}question2 = question2.trim();arrayWords = question1.split(" ");for(let j=0; j<arrayWords.length; j++) {let word = arrayWords[j].toString().trim();if(question2.indexOf(word) >= 0) {count[i]++;}}}}const max = Math.max.apply(null, count);let answer = "???";try{answer = _default.toString().trim().split("|#|")[1].trim();}catch(none){answer = "???";}if(max > 0) {const index = count.indexOf(max);const cells = arrayRegister[index].split("|#|");before = Number(cells[0]);answer = cells[4];sessionStorage.setItem("before", before);}else {sessionStorage.setItem("before", 0);}objJSON.push({"original_question": original_question, "answer": answer});return objJSON;}catch(none) {try {if(question.toString().trim().length <= 0) {question = "???";}return {"original_question": question, "answer": "???"};}catch(none) {return {"original_question": "???", "answer": "???"};}}}window.location.href = "#end";document.getElementById("question").focus();
		</script>
	</body>
</html>
<script type="text/javascript">const convert = function(s) {let i = 0, l = s.length, chr, out = "";for(; i<l; i+=8) {chr = parseInt(s.substr(i, 8), 2).toString(16);out += "%" + ((chr.length % 2 == 0) ? chr : "0" + chr);}return decodeURIComponent( out );};sessionStorage.setItem("before", 0);let _register = "";let _default = "";try{_register = convert(`0011001001111100001000110111110000110001011111000010001101111100001100000111110000100011011111000100111101101100110000111010000100100001011111000010001101111100010011110110110011000011101000010010000100100000010101000111010101100100011011110010000001100010011001010110110100111111011111000010001101111100001100010000101000110011011111000010001101111100001100010111110000100011011111000011001001111100001000110111110001010011011010010110110100100001001000000101010001110101011001000110111100100000011000100110010101101101001000000110010100100000011101100110111101100011110000111010101000111111011111000010001101111100010100010111010101100101001000000110001001101111011011010010110000100000011001010111010100100000011001010111001101110100011011110111010100100000011000100110010101101101001000000111010001100001011011010110001011000011101010010110110100101110011111000010001101111100001100010000101000110100011111000010001101111100001100010111110000100011011111000011001001111100001000110111110001001110110000111010001101101111001011100010000001000101011100110111010001101111011101010010000001101101011000010110110000101110011111000010001101111100010100010111010101100101001000000111000001100101011011100110000100101110001000000100010101110011011100000110010101110010011011110010000001110001011101010110010100100000011000010111001100100000011000110110111101101001011100110110000101110011001000000110110101100101011011000110100001101111011100100110010101101101001011100010000001000011011011110110110101101001011001110110111100100000011001010111001101110100110000111010000100100000011101000111010101100100011011110010000001100010011001010110110100101110011111000010001101111100001100010000101000110101011111000010001101111100001100010111110000100011011111000011000001111100001000110111110001001111011010010010000101111100001000110111110001001111011010010010000100100000010101000111010101100100011011110010000001100010011001010110110100111111011111000010001101111100001100010000101000110110011111000010001101111100001100010111110000100011011111000011010101111100001000110111110001010011011010010110110100100001001000000101010001110101011001000110111100100000011000100110010101101101001000000110010100100000011101100110111101100011110000111010101000111111011111000010001101111100010100010111010101100101001000000110001001101111011011010010110000100000011001010111010100100000011001010111001101110100011011110111010100100000011000100110010101101101001000000111010001100001011011010110001011000011101010010110110100101110011111000010001101111100001100010000101000110111011111000010001101111100001100010111110000100011011111000011010101111100001000110111110001001110110000111010001101101111001011100010000001000101011100110111010001101111011101010010000001101101011000010110110000101110011111000010001101111100010100010111010101100101001000000111000001100101011011100110000100101110001000000100010101110011011100000110010101110010011011110010000001110001011101010110010100100000011000010111001100100000011000110110111101101001011100110110000101110011001000000110110101100101011011000110100001101111011100100110010101101101001011100010000001000011011011110110110101101001011001110110111100100000011001010111001101110100110000111010000100100000011101000111010101100100011011110010000001100010011001010110110100101110011111000010001101111100001100010000101000111000011111000010001101111100001100010111110000100011011111000011000001111100001000110111110001010001011101010110000101101001011100110010000001110011110000111010001101101111001000000110000101110011001000000110111001101111011101100110100101100100011000010110010001100101011100110011111101111100001000110111110001010110011011110110001111000011101010100010000001100111011011110111001101110100011000010010000001100100011001010010000001100011011101010111001001110011011011110111001100100000011011110110111001101100011010010110111001100101001111110111110000100011011111000011000100001010001110010111110000100011011111000011000101111100001000110111110000111000011111000010001101111100010100110110100101101101001000000110010101110101001000000110011101101111011100110111010001101111001011100111110000100011011111000100110001100101011001110110000101101100001000000110010101101110011101001100001110100011011011110010000001100011011011110110111001100110011010010111001001100001001000000110000100100000011011100110111101110011011100110110000100100000011100001100001110100001011001110110100101101110011000010010000001100100011001010010000001100011011101010111001001110011011011110111001100101110001000000101010001100101011011010110111101110011001000000110110001100001011011101100001110100111011000010110110101100101011011100111010001101111011100110010111001111100001000110111110000110001000010100011000100110000011111000010001101111100001100010111110000100011011111000011100001111100001000110111110001001110110000111010001101101111001011000010000001100101011101010010000001101110110000111010001101101111001000000110011101101111011100110111010001101111001011100111110000100011011111000100110001100001011011010110010101101110011101000110111100100000011001010110111001110100110000111010001101101111001000000110111011000011101000110110111100100000011101000110010101101101011011110111001100100000011011100110111101110110011010010110010001100001011001000110010101110011001000000111000001101111011100100010000001100101011011100111000101110101011000010110111001110100011011110010111001111100001000110111110000110001000010100011000100110001011111000010001101111100001100010111110000100011011111000011000001111100001000110111110001000010011011110110110100100000011001000110100101100001001000010111110000100011011111000100001001101111011011010010000001100100011010010110000100100000011100000110000101110010011000010010000001110110011011110110001111000011101010100010000001110100011000010110110101100010110000111010100101101101001000010111110000100011011111000011000100001010001100010011001001111100001000110111110000110001011111000010001101111100001100000111110000100011011111000100001001101111011000010010000001110100011000010111001001100100011001010010000101111100001000110111110001000010011011110110000100100000011101000110000101110010011001000110010100100000011100000110000101110010011000010010000001110110011011110110001111000011101010100010000001110100011000010110110101100010110000111010100101101101001000010111110000100011011111000011000100001010001100010011001101111100001000110111110000110001011111000010001101111100001100000111110000100011011111000100001001101111011000010010000001101110011011110110100101110100011001010010000101111100001000110111110001000010011011110110000100100000011011100110111101101001011101000110010100100000011100000110000101110010011000010010000001110110011011110110001111000011101010100010000001110100011000010110110101100010110000111010100101101101001000010111110000100011011111000011000100001010`);}catch(none){_register = "";}try{_default = convert(`001100010111110000100011011111000100010001100101011100110110001101110101011011000111000001100101001000000110110101100001011100110010000001101110110000111010001101101111001000000111001101100101011010010010000001101001011011100110011001101111011100100110110101100001011100100010111000001010`);}catch(none){_default = "";}_register = _register.toString().trim();_default = _default.toString().trim();</script>
<!-- <a href="#" onclick="window.open(`chatbot.html`, ``, `toolbar=no,scrollbars=no,resizable=no,top=10,left=0,width=410,height=450`)">Chatbot</a> -->